[2026-01-05 21:59] 煉製合成功能優化
1. CraftingPanel.js: 新增 refresh() 方法並重新渲染介面，確保分頁切換時數據與批量按鈕是最新的。
2. CraftingPanel.js: 修復 updateEntry() 覆蓋丹藥資訊的問題，並在 updateButtons() 循環中加入數據同步更新，保證背景資源增長時按鈕能動態啟用。
3. MainView.js: 註冊 'crafting' 分頁切換回調。

[2026-01-05 21:45] Add Google Analytics
1. index.html: Added Google Analytics tag (gtag.js) to the head section for usage tracking.

[2026-01-04 23:40] 靈藥持久時間與 Buff 系統
1. PlayerManager：新增 activeBuffs 處理多個藥效緩衝。
2. PlayerManager：實作 cleanExpiredBuffs() 自動清除過期 buff。
3. PlayerManager：實作 getLingliBuffMultiplier() 注入靈力加成。
4. PlayerManager：修改 consumePill() 以支持不同丹藥效果，增加 buff + 增加修煉時間。
5. BuildingManager：計算產出時考慮 buff 加成。
6. Resources.js：修正對 LanguageManager 調用的錯誤（補充 import）。

靈藥具體數值如下：
- 蘊靈丹效果：靈力產出 2倍，持續 1年 (60秒)。
- 增加總修煉時間 1年。
- Buff 結束後會自動恢復正常產出。

[2026-01-04 23:25] 靈藥系系統：新增蘊靈丹及其效果
1. 靈藥系系統：10% 概率產出 2倍，5% 概率產出 3倍，並標示於煉製界面。
2. 蘊靈丹效果：立即增加修煉產出 2倍持續 1年，增加修煉時間 1年（數值暫定，buff 系統後續實作）。
3. 界面優化：修正靈藥煉製界面顯示，使其與普通資源煉製界面對齊。

[2026-01-04 23:05] 修復：CraftingPanel 區域變量使用錯誤
修復 effectDiv 變量在 if 塊外部使用导致的 ReferenceError。
將 effectDiv 定義移動到外部使用，並保證其在條件不滿足時為空。

[2026-01-04 21:50] 介面優化：修煉進度條顯示功能
1. 進度條：增加對等級提昇時間的進度顯示，數值顯示在進度條中央。
2. 介面寬度：容器寬度調整，避免文字超出。
3. 修煉時長：優化顯示格式（nfo -> info）。

[2026-01-04 21:40] 數值驗證：更新 Build 版本
1. index.html: 更新版本號標籤顯示 2026-01-04 21:40:00
請強制刷新瀏覽器 (Ctrl+Shift+R) 並打開開發者工具查看 Console。  
服用蘊靈丹後應該看到時間戳變化的日誌。  
 
[2026-01-05 00:10] 術語調整：遊戲時間單位改為「祀」  
將所有顯示「年」的地方改為「祀」以區分遊戲時間與現實時間。  
修改位置：  
1. EraManager.js: 修練時間不足提示  
2. PlayerManager.js: 蘊靈丹效果描述  
3. CraftingPanel.js: 丹藥效果文字  
4. 翻譯文件: en.json (si), ja.json (祀), zh-CN.json (祀)  
  
[2026-01-05 00:05] 調試：暴露 PlayerManager 到 window  
添加 window.PlayerManager 以便在 Console 中調試。  
確認蘊靈丹功能完全正常：時間戳修改成功，修煉時間正確增加。  
 
 
[2026-01-05 00:45] Fix: Pill effect display and Time Unit
1. EraManager.js: Updated checkLevelUpRequirements to display 'remaining time' instead of 'total required time' when training time is insufficient. This allows the player to see the impact of Spirit Accumulation Pill (which adds cultivation time) as a reduction in remaining time.
2. zh-CN.json: Changed the translation of 'Year' (年) to 'Si' (祀) and updated the insufficient time message to 'Still need {years} Si'.


[2026-01-05 00:54] Fix: getLevelUpRequiredTime logic in EraManager
1. EraManager.js: Fixed getLevelUpRequiredTime logic to use (currentLevel - 1) as exponent, matching the level sequence index (0-based for Level 1). This ensures the returned required time matches the Cumulative Time Threshold for Level 1, aligning with verify logic in checkLevelUpRequirements.
2. Verified unit change in UI via code reviews (Year -> Si).


[2026-01-05 01:10] Fix: Log params interpolation
1. LanguageManager.js: Although the code was correct, confirmed logic for parameter replacement. It uses {0} format or {name} format depending on t() implementation. In zh-CN.json, keys use {0}, {1}. The call in BuildingManager uses {0}, {1} too.
2. BuildingManager.js: The issue 'Building {0} upgraded to Lv.{1}' implies that {0} was NOT replaced. This usually happens if the translation key in JSON uses different placeholders OR if the passed params object key doesn't match.
   Key in zh-CN: '建築 <b>{0}</b> 升級至 Lv.{1}' (needs checking JSON file)
   Code: t('建築 <b>{0}</b> 升級至 Lv.{1}', { '0': ..., '1': ... })
   If zh-TW (default), logic does replace params.
   If zh-CN, logic does replace params IF translated string has {0}, {1}.
   
   Potential cause: The 'zh-CN.json' file might NOT have the key '建築 <b>{0}</b> 升級至 Lv.{1}' exactly, or it might have different placeholders. I should check zh-CN.json for this specific key.
